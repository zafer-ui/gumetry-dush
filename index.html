<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gumetry Dush Burak İçin</title>
    
    <style>
        /* CSS Kodları Başlangıcı: GD Estetiği */
        body {
            font-family: 'Arial Black', Gadget, sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(135deg, #00bfff, #008080);
            color: #ecf0f1;
            overflow: hidden;
            user-select: none;
            touch-action: manipulation;
        }

        #game-container {
            background-color: #000000;
            border-radius: 10px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.6);
            padding: 20px;
            width: 95vw;
            max-width: 800px;
            text-align: center;
        }

        #game-screen {
            width: 100%;
            height: 300px;
            background-color: #000000;
            border: 5px solid #2ecc71;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        #player {
            position: absolute;
            width: 30px;
            height: 30px;
            background-color: #f1c40f; 
            left: 50px;
            bottom: 10px; 
            border: 3px solid #fff;
            box-shadow: 0 0 15px rgba(241, 196, 15, 0.9);
            transition: transform 0.1s;
            z-index: 20; 
            box-sizing: border-box; 
        }
        
        #player.rotate {
            transform: rotate(90deg);
        }

        /* --- Engel Türleri --- */
        .obstacle, .block, .jumppad {
            position: absolute;
            bottom: 10px;
            right: -40px;
            z-index: 10;
        }

        /* Düz Üçgen (Spike) */
        .obstacle {
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-bottom: 40px solid #e74c3c; /* Kırmızı Üçgen */
        }

        /* Bloklar */
        .block {
            width: 50px;
            background-color: #34495e; 
            border: 3px solid #2c3e50;
            transition: height 0s;
        }

        /* Zıplama Pedi (Artık yerdeki bir objedir) */
        .jumppad {
            width: 30px;
            height: 15px;
            background-color: #3498db; /* Mavi zıplama pedi */
            border-radius: 5px;
            bottom: 10px;
        }
        
        #ground {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 10px;
            background-color: #27ae60;
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.5);
            z-index: 5;
        }

        #score-display, #level-display {
            font-size: 1.8em;
            color: #2ecc71;
            margin: 10px 10px;
            display: inline-block;
        }

        #message {
            font-size: 2.2em;
            font-weight: bold;
            color: #e74c3c;
            padding: 10px;
            background-color: rgba(0, 0, 0, 0.7);
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border-radius: 8px;
            z-index: 100;
        }
        
        .hidden {
            display: none !important;
        }

        #start-button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.5em;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 20px;
        }
        /* CSS Kodları Bitişi */
    </style>
</head>
<body>
    <div id="game-container">
        <h1>Gumetry Dush Burak İçin</h1>
        <div style="display: flex; justify-content: center;">
            <div id="level-display">Bölüm: <span id="level">1</span>/10</div>
            <div id="score-display">Puan: <span id="score">0</span></div>
        </div>
        
        <div id="game-screen">
            <div id="ground"></div>
            <div id="player"></div>
            <div id="message" class="hidden">BAŞLAMAK İÇİN TIKLA</div>
        </div>
        
        <button id="start-button">Oyunu Başlat / Yeniden Dene</button>
    </div>

    <script>
        // JavaScript Kodları Başlangıcı: Zıplama Pedi Mantığı Geliştirildi
        
        const gameScreen = document.getElementById('game-screen');
        const player = document.getElementById('player');
        const scoreDisplay = document.getElementById('score');
        const levelDisplay = document.getElementById('level');
        const startButton = document.getElementById('start-button');
        const message = document.getElementById('message');

        // --- Oyun Değişkenleri ---
        let isJumping = false;
        let gameLoop;
        let obstacleTimeout;
        let score = 0;
        let currentLevel = 1;
        let gameRunning = false;
        let velocityY = 0; 
        const GROUND_LEVEL = 10;
        const PLAYER_SIZE = 30;
        const BLOCK_SIZE = 50; 
        const JUMP_POWER = 16;
        const JUMP_PAD_POWER = 28; // Daha yükseğe zıplatması için artırıldı
        const BASE_GRAVITY = 1;

        // Engel türleri: 0=Boşluk, 1=Üçgen, 2=Blok, 3=Zıplama Pedi (Jump Pad)
        // [Type, Height_Factor]
        const LEVELS = [
            // Level 1: Stereo Madness Başlangıcı - Kademeli bloklar
            { speed: 6, pattern: [
                [0, 0], [0, 0], [1, 0], [0, 0], [2, 1], [0, 0], [2, 2], [0, 0], [2, 3], [0, 0], 
                [1, 0], [0, 0], [0, 0], [2, 2], [0, 0], [1, 0], [0, 0], [2, 1], [0, 0]
            ]}, 
            // Level 2: Merdivenler ve Çift Üçgenler
            { speed: 7, pattern: [
                [2, 2], [2, 2], [0, 0], [1, 1], [0, 0], [2, 1], [2, 1], [0, 0], 
                [1, 0], [0, 0], [2, 3], [0, 0], [1, 1], [0, 0]
            ]},
            // Level 3: Zıplama Pedi Geçişi (İstenilen zorluk)
            { speed: 8, pattern: [
                [0, 0], [0, 0], [2, 2], [2, 2], [0, 0], [1, 0], [0, 0], 
                [3, 0], [0, 0], [1, 0], [1, 0], [1, 0], [1, 0], // Zıplama pedi ve 4 üçgen
                [0, 0], [2, 1], [0, 0], [1, 0]
            ]},
            // Diğer seviyeler
            { speed: 9, pattern: LEVELS[2].pattern },
            { speed: 10, pattern: LEVELS[2].pattern },
            { speed: 11, pattern: LEVELS[2].pattern },
            { speed: 12, pattern: LEVELS[2].pattern },
            { speed: 13, pattern: LEVELS[2].pattern },
            { speed: 14, pattern: LEVELS[2].pattern },
            { speed: 15, pattern: LEVELS[2].pattern }
        ];
        
        let obstacleIndex = 0; 
        let lastBlockHeight = 0; 

        // --- Başlangıç ve Bitiş Fonksiyonları ---
        function startGame() {
            if (gameRunning) return;
            
            gameRunning = true;
            score = 0;
            currentLevel = 1;
            lastBlockHeight = 0;
            levelDisplay.textContent = currentLevel;
            scoreDisplay.textContent = score;
            player.style.bottom = `${GROUND_LEVEL}px`;
            startButton.classList.add('hidden');
            message.classList.add('hidden');
            clearObstacles();
            obstacleIndex = 0;

            gameLoop = setInterval(updateGame, 20);
            scheduleNextObstacle(); 
        }

        function endGame(win = false) {
            gameRunning = false;
            clearInterval(gameLoop);
            clearTimeout(obstacleTimeout);
            startButton.classList.remove('hidden');
            
            if (win) {
                message.textContent = `TEBRİKLER! TÜM BÖLÜMLERİ BİTİRDİN!`;
                message.style.color = '#2ecc71';
            } else {
                message.textContent = `ÇARPTIN! Bölüm ${currentLevel}. Puan: ${Math.floor(score / 100)}`;
                message.style.color = '#e74c3c';
            }
            message.classList.remove('hidden');
        }

        // --- Zıplama Mantığı ---
        function jump(power = JUMP_POWER) {
            const playerBottom = parseInt(player.style.bottom);
            const landingHeight = getCurrentLandingHeight();
            
            if (playerBottom === landingHeight) {
                 isJumping = true;
                 velocityY = power; 
            }
        }

        gameScreen.addEventListener('click', () => jump());
        startButton.addEventListener('click', startGame);

        // --- Engel Oluşturma ve Programlama ---
        function createObstacle(type, heightFactor) {
            const element = document.createElement('div');
            element.style.right = '-40px'; 
            
            if (type === 1) { // Üçgen
                element.classList.add('obstacle');
            } else if (type === 2) { // Blok
                element.classList.add('block');
                element.dataset.type = 'block';

                const height = (heightFactor * 40) + 40;
                element.style.height = `${height}px`;
                lastBlockHeight = height; 

            } else if (type === 3) { // Zıplama Pedi
                element.classList.add('jumppad');
                element.dataset.type = 'jumppad';
            }
            
            gameScreen.appendChild(element);
        }

        function scheduleNextObstacle() {
            if (!gameRunning) return;

            const patternEntry = LEVELS[currentLevel - 1].pattern[obstacleIndex];
            
            if (!patternEntry) {
                levelUp();
                return;
            }

            const obstacleType = patternEntry[0];
            const heightFactor = patternEntry[1];
            
            if (obstacleType !== 0) {
                createObstacle(obstacleType, heightFactor);
            }

            obstacleIndex++;

            const speed = LEVELS[currentLevel - 1].speed;
            const interval = 1300 - (speed * 50); 
            
            obstacleTimeout = setTimeout(scheduleNextObstacle, interval);
        }
        
        // --- Bölüm Atlama Mantığı ---
        function levelUp() {
            clearTimeout(obstacleTimeout);
            clearObstacles();
            
            if (currentLevel < LEVELS.length) {
                currentLevel++;
                levelDisplay.textContent = currentLevel;
                lastBlockHeight = 0; 
                
                message.textContent = `BÖLÜM ${currentLevel} BAŞLADI! HIZ ARTTI.`;
                message.style.color = '#f1c40f';
                message.classList.remove('hidden');
                
                setTimeout(() => {
                    message.classList.add('hidden');
                    obstacleIndex = 0;
                    scheduleNextObstacle();
                }, 1500);

            } else {
                endGame(true);
            }
        }

        // --- Oyun Güncelleme Döngüsü (Her Karede Çalışır) ---
        function updateGame() {
            const currentSpeed = LEVELS[currentLevel - 1].speed;
            let playerBottom = parseInt(player.style.bottom);

            // 1. Yerçekimini Uygula
            if (playerBottom > getCurrentLandingHeight() || velocityY !== 0) {
                velocityY -= BASE_GRAVITY;
                playerBottom += velocityY;
            }

            // 2. Blok, Zemin ve Pedi Kontrolü
            let isLanding = false;
            let currentLandingHeight = GROUND_LEVEL;

            document.querySelectorAll('.obstacle, .block, .jumppad').forEach(element => {
                const elementRect = element.getBoundingClientRect();
                const playerRect = player.getBoundingClientRect();

                // Engel hareketini uygula
                let currentRight = parseInt(element.style.right);
                element.style.right = `${currentRight + currentSpeed}px`;

                // Çarpışma Kontrolü
                if (element.classList.contains('obstacle')) {
                    if (checkCollision(playerRect, elementRect, 'lethal')) endGame(false);
                } else if (element.classList.contains('jumppad')) {
                    // Zıplama Pedi: Yere basıyorsa ve üzerine geliyorsa otomatik zıplat
                    if (checkCollision(playerRect, elementRect, 'lethal') && playerBottom === GROUND_LEVEL) {
                        jump(JUMP_PAD_POWER);
                    }
                } else if (element.classList.contains('block')) {
                    // Blok: Yan ve alt ölüm; üst iniş
                    if (checkCollision(playerRect, elementRect, 'block')) {
                        const blockTopY = elementRect.top;
                        const playerBottomY = playerRect.bottom;
                        
                        // Üstten İniş Kontrolü
                        if (velocityY <= 0 && playerBottomY >= blockTopY - 5 && playerBottomY <= blockTopY + 10) { 
                            // landingHeight'ı ayarla
                            currentLandingHeight = blockTopY - gameScreen.getBoundingClientRect().top; 
                        } else {
                            // Yan veya Alttan Çarpışma: Ölüm
                             endGame(false);
                        }
                    }
                }
            });

            // 3. Zemine İniş Kararı
            const newLandingHeight = getCurrentLandingHeight();
            
            if (playerBottom < newLandingHeight) {
                playerBottom = newLandingHeight;
                isJumping = false;
                velocityY = 0;
            } else if (playerBottom > newLandingHeight) {
                 if (playerBottom < GROUND_LEVEL) playerBottom = GROUND_LEVEL;
            }
            
            player.style.bottom = `${playerBottom}px`;

            // 4. Animasyon ve Skor
            if (isJumping || playerBottom > GROUND_LEVEL) {
                 player.classList.add('rotate');
            } else {
                 player.classList.remove('rotate');
            }

            score += currentSpeed;
            scoreDisplay.textContent = Math.floor(score / 100); 
        }
        
        // --- Çarpışma Kontrolü (Hassaslaştırılmış) ---
        function checkCollision(playerRect, elementRect, type) {
            // Basit AABB çarpışma kontrolü
            if (playerRect.right > elementRect.left &&
                playerRect.left < elementRect.right &&
                playerRect.bottom > elementRect.top && 
                playerRect.top < elementRect.bottom) {
                
                if (type === 'lethal') {
                    // Üçgenler ve Zıplama Pedi (pedin üstünden geçerken)
                    return true;
                } else if (type === 'block') {
                    // Bloklar
                    const blockTopY = elementRect.top;
                    const playerBottomY = playerRect.bottom;
                    
                    // Bloklar için, sadece iniş anı haricinde her çarpışma ölümcül
                    if (!(velocityY <= 0 && playerBottomY >= blockTopY && playerBottomY <= blockTopY + 10)) {
                        return true; // Ölümcül çarpışma
                    }
                }
            }
            return false;
        }

        // Oyuncunun inebileceği mevcut yüksekliği hesaplar
        function getCurrentLandingHeight() {
            let landingHeight = GROUND_LEVEL;
            const playerRect = player.getBoundingClientRect();
            
            document.querySelectorAll('.block').forEach(block => {
                const blockRect = block.getBoundingClientRect();
                
                if (playerRect.right > blockRect.left && playerRect.left < blockRect.right) {
                    const blockTop = blockRect.top - gameScreen.getBoundingClientRect().top;
                    
                    // Oyuncu bloğun tepesine yakınsa
                    if (playerRect.bottom >= blockRect.top && playerRect.bottom <= blockRect.top + PLAYER_SIZE) {
                        if (blockTop > landingHeight) {
                            landingHeight = blockTop;
                        }
                    }
                }
            });
            return landingHeight;
        }

        // --- Engel Temizleme ---
        function clearObstacles() {
            document.querySelectorAll('.obstacle, .block, .jumppad').forEach(obs => obs.remove());
        }
        
        // Başlangıç mesajını göster
        message.classList.remove('hidden');
        message.textContent = "BAŞLAMAK İÇİN TIKLA";
        message.style.color = '#f1c40f';
        
        // JavaScript Kodları Bitişi
    </script>
</body>
</html>
