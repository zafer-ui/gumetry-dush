<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geometry Dash Klonu (Bloklar ve Üçgenler)</title>
    
    <style>
        /* CSS Kodları Başlangıcı */
        body {
            font-family: 'Arial Black', Gadget, sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(135deg, #1c1c1c, #444);
            color: #ecf0f1;
            overflow: hidden;
            user-select: none;
            touch-action: manipulation;
        }

        #game-container {
            background-color: #2c3e50;
            border-radius: 10px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.6);
            padding: 20px;
            width: 95vw;
            max-width: 800px;
            text-align: center;
        }

        #game-screen {
            width: 100%;
            height: 300px;
            background-color: #1a1a1a;
            border: 5px solid #f1c40f;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        #player {
            position: absolute;
            width: 30px;
            height: 30px;
            background-color: #3498db;
            left: 50px;
            bottom: 10px; 
            border: 3px solid #fff;
            box-shadow: 0 0 15px rgba(52, 152, 219, 0.8);
            transition: transform 0.1s;
            z-index: 20; /* Oyuncunun üstte görünmesini sağlar */
        }
        
        #player.rotate {
            transform: rotate(90deg);
        }

        /* --- Engel Türleri --- */
        .obstacle, .block {
            position: absolute;
            bottom: 10px;
            right: -40px;
            z-index: 10;
        }

        .obstacle {
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-bottom: 40px solid #e74c3c; /* Kırmızı Üçgen */
            transform: rotate(180deg); 
        }

        .block {
            width: 50px;
            height: 80px; /* Daha yüksek bloklar */
            background-color: #7f8c8d; /* Gri bloklar */
            border: 3px solid #bdc3c7;
        }
        
        #ground {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 10px;
            background-color: #f39c12;
            box-shadow: 0 5px 15px rgba(243, 156, 18, 0.5);
            z-index: 5;
        }

        #score-display, #level-display {
            font-size: 1.8em;
            color: #2ecc71;
            margin: 10px 10px;
            display: inline-block;
        }

        #message {
            font-size: 2.2em;
            font-weight: bold;
            color: #e74c3c;
            padding: 10px;
            background-color: rgba(0, 0, 0, 0.7);
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border-radius: 8px;
            z-index: 100;
        }
        
        .hidden {
            display: none !important;
        }

        #start-button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.5em;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 20px;
        }
        /* CSS Kodları Bitişi */
    </style>
</head>
<body>
    <div id="game-container">
        <h1>GEOMETRY DASH KLONU</h1>
        <div style="display: flex; justify-content: center;">
            <div id="level-display">Bölüm: <span id="level">1</span>/10</div>
            <div id="score-display">Puan: <span id="score">0</span></div>
        </div>
        
        <div id="game-screen">
            <div id="ground"></div>
            <div id="player"></div>
            <div id="message" class="hidden">BAŞLAMAK İÇİN TIKLA</div>
        </div>
        
        <button id="start-button">Oyunu Başlat / Yeniden Dene</button>
    </div>

    <script>
        // JavaScript Kodları Başlangıcı: Blok Çarpışması Eklendi
        
        const gameScreen = document.getElementById('game-screen');
        const player = document.getElementById('player');
        const scoreDisplay = document.getElementById('score');
        const levelDisplay = document.getElementById('level');
        const startButton = document.getElementById('start-button');
        const message = document.getElementById('message');

        // --- Oyun Değişkenleri ---
        let isJumping = false;
        let gameLoop;
        let obstacleTimeout;
        let score = 0;
        let currentLevel = 1;
        let gameRunning = false;
        let velocityY = 0; 
        const GROUND_LEVEL = 10;
        const PLAYER_SIZE = 30;
        const JUMP_POWER = 16; // Zıplama gücü artırıldı
        const BASE_GRAVITY = 1;

        // Engel türleri: 0=Boşluk, 1=Üçgen, 2=Blok
        const LEVELS = [
            { speed: 6, pattern: [0, 1, 0, 0, 2, 0, 1, 1, 0, 2, 0, 1, 0, 0, 2, 1, 0, 1] }, // Başlangıç seviyesi
            { speed: 7, pattern: [1, 0, 2, 0, 1, 1, 0, 2, 2, 0, 1, 0, 2, 0, 1, 1, 0, 2] },
            { speed: 8, pattern: [1, 2, 0, 1, 1, 2, 0, 2, 1, 0, 1, 2, 1, 1, 0, 2, 2, 1] },
            { speed: 9, pattern: [1, 0, 1, 2, 1, 0, 2, 1, 2, 0, 1, 2, 2, 1, 0, 1, 2, 1] },
            { speed: 10, pattern: [1, 1, 2, 0, 1, 2, 1, 1, 2, 1, 0, 2, 1, 1, 2, 1, 0, 1] },
            { speed: 11, pattern: [1, 2, 1, 2, 1, 0, 2, 1, 2, 1, 2, 1, 0, 2, 1, 2, 1, 0] },
            { speed: 12, pattern: [1, 1, 2, 2, 1, 0, 1, 2, 2, 1, 1, 0, 2, 2, 1, 1, 2, 1] },
            { speed: 13, pattern: [1, 2, 2, 1, 1, 2, 2, 1, 1, 2, 2, 1, 1, 2, 2, 1, 1, 2] },
            { speed: 14, pattern: [1, 1, 1, 2, 2, 2, 1, 1, 1, 2, 2, 2, 1, 1, 1, 2, 2, 2] },
            { speed: 15, pattern: [1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2] } // Maksimum zorluk
        ];
        
        let obstacleIndex = 0; 

        // --- Başlangıç ve Bitiş Fonksiyonları ---
        function startGame() {
            if (gameRunning) return;
            
            gameRunning = true;
            score = 0;
            currentLevel = 1;
            levelDisplay.textContent = currentLevel;
            scoreDisplay.textContent = score;
            player.style.bottom = `${GROUND_LEVEL}px`;
            startButton.classList.add('hidden');
            message.classList.add('hidden');
            clearObstacles();
            obstacleIndex = 0;

            gameLoop = setInterval(updateGame, 20); // Ana oyun döngüsü
            scheduleNextObstacle(); 
        }

        function endGame(win = false) {
            gameRunning = false;
            clearInterval(gameLoop);
            clearTimeout(obstacleTimeout);
            startButton.classList.remove('hidden');
            
            if (win) {
                message.textContent = `TEBRİKLER! TÜM BÖLÜMLERİ BİTİRDİN!`;
                message.style.color = '#2ecc71';
            } else {
                message.textContent = `ÇARPTIN! Bölüm ${currentLevel}. Puan: ${Math.floor(score / 100)}`;
                message.style.color = '#e74c3c';
            }
            message.classList.remove('hidden');
        }

        // --- Zıplama Mantığı ---
        function jump() {
            // Sadece zemindeyse veya bir bloğun üstündeyse zıplamaya izin ver
            const playerBottom = parseInt(player.style.bottom);
            if (playerBottom === GROUND_LEVEL || isStandingOnBlock()) {
                 isJumping = true;
                 velocityY = JUMP_POWER; 
            }
        }

        gameScreen.addEventListener('click', jump);
        startButton.addEventListener('click', startGame);

        // --- Engel Oluşturma ve Programlama ---
        function createObstacle(type) {
            const element = document.createElement('div');
            element.style.right = '-40px'; 
            
            if (type === 1) {
                element.classList.add('obstacle'); // Üçgen
            } else if (type === 2) {
                element.classList.add('block'); // Blok
                element.dataset.type = 'block'; // Çarpışma için tür bilgisi
            }
            
            gameScreen.appendChild(element);
        }

        function scheduleNextObstacle() {
            if (!gameRunning) return;

            const pattern = LEVELS[currentLevel - 1].pattern;
            
            if (obstacleIndex >= pattern.length) {
                levelUp();
                return;
            }

            const obstacleType = pattern[obstacleIndex];
            if (obstacleType !== 0) {
                createObstacle(obstacleType);
            }

            obstacleIndex++;

            const speed = LEVELS[currentLevel - 1].speed;
            const interval = 1300 - (speed * 50); 
            
            obstacleTimeout = setTimeout(scheduleNextObstacle, interval);
        }
        
        // --- Bölüm Atlama Mantığı ---
        function levelUp() {
            clearTimeout(obstacleTimeout);
            clearObstacles();
            
            if (currentLevel < LEVELS.length) {
                currentLevel++;
                levelDisplay.textContent = currentLevel;
                
                message.textContent = `BÖLÜM ${currentLevel} BAŞLADI! HIZ ARTTI.`;
                message.style.color = '#f1c40f';
                message.classList.remove('hidden');
                
                setTimeout(() => {
                    message.classList.add('hidden');
                    obstacleIndex = 0;
                    scheduleNextObstacle();
                }, 1500);

            } else {
                endGame(true); // Tüm bölümler bitti
            }
        }

        // --- Oyun Güncelleme Döngüsü (Her Karede Çalışır) ---
        function updateGame() {
            const currentSpeed = LEVELS[currentLevel - 1].speed;
            let playerBottom = parseInt(player.style.bottom);

            // 1. Yerçekimini Uygula
            if (playerBottom > GROUND_LEVEL || isJumping) {
                velocityY -= BASE_GRAVITY;
                playerBottom += velocityY;
            }

            // 2. Blok ve Zemin Kontrolü
            let isLanding = false;
            let currentLandingHeight = GROUND_LEVEL;

            // Tüm engelleri kontrol et (Çarpışma ve Üstüne Çıkma)
            document.querySelectorAll('.obstacle, .block').forEach(element => {
                const elementRect = element.getBoundingClientRect();
                const playerRect = player.getBoundingClientRect();

                let elementBottom = parseInt(element.style.bottom) || GROUND_LEVEL;
                
                // Engel hareketini uygula
                let currentRight = parseInt(element.style.right);
                element.style.right = `${currentRight + currentSpeed}px`;

                if (element.classList.contains('obstacle')) {
                    // Üçgen Çarpışması
                    if (checkCollision(playerRect, elementRect, element)) {
                        endGame(false);
                    }
                } else if (element.classList.contains('block')) {
                    // Blok Üstüne Çıkma Kontrolü (Sadece düşerken veya zıplama bitmişken)
                    if (playerRect.right > elementRect.left &&
                        playerRect.left < elementRect.right &&
                        playerBottom >= elementRect.height + elementBottom - 5 && // Oyuncunun altı, bloğun tepesinden az farkla yüksekse
                        playerBottom <= elementRect.height + elementBottom + 5 && // ve çok fazla yukarıda değilse
                        velocityY <= 0) { // Oyuncu düşüyorsa
                        
                        isLanding = true;
                        currentLandingHeight = elementRect.height + elementBottom;
                    }
                }
            });

            // 3. Zemine İniş Kararı
            if (isLanding) {
                playerBottom = currentLandingHeight;
                isJumping = false;
                velocityY = 0;
            } else if (playerBottom <= GROUND_LEVEL) {
                playerBottom = GROUND_LEVEL;
                isJumping = false;
                velocityY = 0;
            }
            
            player.style.bottom = `${playerBottom}px`;

            // 4. Animasyon ve Skor
            if (isJumping) {
                 player.classList.add('rotate');
            } else {
                 player.classList.remove('rotate');
            }

            score += currentSpeed;
            scoreDisplay.textContent = Math.floor(score / 100); 
        }
        
        // --- Yardımcı Çarpışma Kontrolü ---
        function checkCollision(playerRect, obstacleRect, element) {
            // Üçgenler için daha hassas kontrol gerekebilir, şimdilik basit AABB kullanıyoruz
            return (playerRect.right > obstacleRect.left &&
                    playerRect.left < obstacleRect.right &&
                    playerRect.bottom > obstacleRect.top + 10 && 
                    playerRect.top < obstacleRect.bottom);
        }
        
        function isStandingOnBlock() {
            const playerRect = player.getBoundingClientRect();
            let onBlock = false;

            document.querySelectorAll('.block').forEach(block => {
                const blockRect = block.getBoundingClientRect();
                const playerBottom = parseInt(player.style.bottom);
                const blockHeight = blockRect.height;
                const blockBottom = parseInt(block.style.bottom) || GROUND_LEVEL;

                if (playerRect.right > blockRect.left &&
                    playerRect.left < blockRect.right &&
                    playerBottom === blockHeight + blockBottom) {
                    onBlock = true;
                }
            });
            return onBlock;
        }

        // --- Engel Temizleme ---
        function clearObstacles() {
            document.querySelectorAll('.obstacle, .block').forEach(obs => obs.remove());
        }
        
        // Başlangıç mesajını göster
        message.classList.remove('hidden');
        message.textContent = "BAŞLAMAK İÇİN TIKLA";
        message.style.color = '#f1c40f';
        
        // JavaScript Kodları Bitişi
    </script>
</body>
</html>
